# 新闻文本分类实验

## 实验概述
本实验旨在使用RNN或LSTM模型对新闻文本进行分类，分类目标为4个类别。实验任务包括构建RNN/LSTM模型，对文本数据进行嵌入或分词的预处理，训练模型并绘制训练损失和验证损失曲线，在测试集上测试模型，并报告性能指标如准确率、F1分数，并展示混淆矩阵。

## 数据集
- **数据集名称**：train.csv 和 test.csv
- **数据集描述**：包含新闻文本及其对应类别的标签。
- **数据集分割**：使用train.csv作为训练集和验证集，按4:1比例划分；使用test.csv作为测试集。

## 数据预处理
- 文本数据通过空格进行分割。
- 构建词汇表，将文本转换为词汇表索引。
- 数据转换为Tensor，并进行填充以确保相同长度。

## 模型架构
- **模型类型**：LSTM
- **嵌入层**：将词汇索引映射到嵌入向量。
- **LSTM层**：使用双向LSTM捕获序列特征。
- **全连接层**：将LSTM输出映射到4个类别。

## 超参数设置
- **损失函数**：交叉熵损失（CrossEntropyLoss）。
- **优化器**：Adam优化器，学习率为0.001。
- **Epoch**：10个Epoch进行训练。
- **隐藏层维度**：128
- **嵌入维度**：100
- **双向LSTM**：是
- **Dropout**：0.5

## 实验结果
- **loss下降曲线**：
![image](https://github.com/user-attachments/assets/1e2eac3b-7148-40df-92ab-0707f68f0e34)
- **准确率（Accuracy）**：0.909605
- **F1分数（F1 Score）**：0.909423
- **精确率（Precision）**：0.909715
- **召回率（Recall）**：0.909605
- **混淆矩阵（Confusion Matrix）**：
- ![image](https://github.com/user-attachments/assets/6c7df10d-bbac-4c40-a231-0e85aae83db5)

## 代码文件
- **模型定义**：包含模型的定义。
- **数据加载与预处理**：包含数据加载、词汇表构建、文本转换为序列的代码。
- **训练和测试脚本**：包含模型训练、验证、测试以及性能指标计算的代码。

## 运行环境
- **Python版本**：Python 3.10
- **PyTorch版本**：PyTorch 2.2.1
- **依赖库**：torch, torchvision, sklearn, matplotlib, pandas

## 运行指南
1. 确保所有依赖库已安装。
2. 运行主脚本开始训练模型并进行测试。

## 注意事项
- 请确保数据文件`train.csv`和`test.csv`位于正确的路径下。
- 模型训练过程中会输出每个Epoch的训练损失和验证损失，并保存loss曲线
